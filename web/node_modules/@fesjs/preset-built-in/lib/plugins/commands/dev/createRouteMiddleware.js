"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _path = require("path");

var _connectHistoryApiFallback = _interopRequireDefault(require("connect-history-api-fallback"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const ASSET_EXT_NAMES = ['.ico', '.png', '.jpg', '.jpeg', '.gif', '.svg'];

var _default = api => (req, res, next) => {
  const proxyConfig = api.config.proxy;

  if (proxyConfig && Object.keys(proxyConfig).some(path => req.path.startsWith(path))) {
    return next();
  }

  if (req.path === '/favicon.ico') {
    return res.sendFile((0, _path.join)(__dirname, 'fes.png'));
  }

  if (ASSET_EXT_NAMES.includes((0, _path.extname)(req.path))) {
    return next();
  }

  const history = (0, _connectHistoryApiFallback.default)();
  history(req, res, next);
};

exports.default = _default;