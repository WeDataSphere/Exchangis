"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getLocales = getLocales;
exports.getLocalesJSON = getLocalesJSON;

var _utils = require("@fesjs/utils");

var _path = require("path");

function getLocales(cwd) {
  const files = _utils.glob.sync('*.js', {
    cwd
  }).filter(file => !file.endsWith('.d.ts') && !file.endsWith('.test.js') && !file.endsWith('.test.jsx')).map(fileName => {
    const locale = (0, _path.basename)(fileName, '.js');
    return {
      locale,
      message: `require('${(0, _path.join)(cwd, fileName)}').default`
    };
  });

  return files;
}

function getLocalesJSON(cwd) {
  const locales = getLocales(cwd);
  return JSON.stringify(locales, null, 2).replace(/"message": ("(.+?)")/g, (global, m1, m2) => `"message": ${m2.replace(/\^/g, '"')}`).replace(/\\r\\n/g, '\r\n').replace(/\\n/g, '\r\n');
}