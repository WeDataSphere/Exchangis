/*!
 * @form-create/component-antdv-frame v3.1.3
 * (c) 2018-2022 xaboy
 * Github https://github.com/xaboy/form-create with frame
 * Released under the MIT License.
 */
import{openBlock as e,createElementBlock as t,createElementVNode as n,defineComponent as i,resolveComponent as o,createVNode as r,isVNode as l,nextTick as c,mergeProps as a}from"vue";function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return Array.isArray(e)?e:[null,void 0,""].indexOf(e)>-1?[]:[e]}function h(e){e=e||new Map;var t={$on:function(t,n){var i=e.get(t);i&&i.push(n)||e.set(t,[n])},$once:function(e,n){n._once=!0,t.$on(e,n)},$off:function(t,n){var i=e.get(t);i&&i.splice(i.indexOf(n)>>>0,1)},$emit:function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(e.get(n)||[]).slice().map((function(e){e._once&&(t.$off(n,e),delete e._once),e.apply(void 0,o)})),(e.get("*")||[]).slice().map((function(e){e(n,o)}))}};return t}var m={name:"CloseCircleOutlined"},p={class:"anticon"},v=[n("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[n("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"}),n("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"})],-1)];m.render=function(n,i,o,r,l,c){return e(),t("span",p,v)};var g={name:"FolderOutlined"},y={class:"anticon"},b=[n("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[n("path",{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 0 0-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z",fill:"currentColor"})],-1)];g.render=function(n,i,o,r,l,c){return e(),t("span",y,b)};var w={name:"FileOutlined"},k={class:"anticon"},x=[n("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[n("path",{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0 0 42 42h216v494z",fill:"currentColor"})],-1)];w.render=function(n,i,o,r,l,c){return e(),t("span",k,x)};var O={name:"DeleteOutlined"},C={class:"anticon"},_=[n("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[n("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z",fill:"currentColor"})],-1)];O.render=function(n,i,o,r,l,c){return e(),t("span",C,_)};var I={name:"EyeOutlined"},B={class:"anticon"},M=[n("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[n("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"})],-1)];I.render=function(n,i,o,r,l,c){return e(),t("span",B,M)};function L(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!l(e)}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}("._fc-frame ._fc-files img{display:inline-block;height:100%;vertical-align:top;width:100%}._fc-frame ._fc-upload-cover{background:rgba(0,0,0,.6);bottom:0;left:0;opacity:0;position:absolute;right:0;top:0;transition:opacity .3s}._fc-frame ._fc-upload-cover ._fc-frame-icon{color:#fff;font-size:16px;margin:0 2px}._fc-frame ._fc-files:hover ._fc-upload-cover{opacity:1}._fc-frame .anticon{font-size:16px;width:16px}._fc-frame .ant-upload{display:block}._fc-frame ._fc-frame-icon,._fc-frame ._fc-upload-btn{cursor:pointer}._fc-files,._fc-frame ._fc-upload-btn{background:#fff;border:1px solid #c0ccda;border-radius:4px;box-shadow:2px 2px 5px rgba(0,0,0,.1);box-sizing:border-box;display:inline-block;height:104px;line-height:104px;margin-right:4px;overflow:hidden;position:relative;text-align:center;width:104px}");var S=i({name:"fcFrame",props:{type:{type:String,default:"input"},field:String,helper:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},src:{type:String,required:!0},icon:{type:String,default:"FolderOutlined"},width:{type:[Number,String],default:500},height:{type:String,default:"370px"},maxLength:{type:Number,default:0},okBtnText:{type:String,default:"确定"},closeBtnText:{type:String,default:"关闭"},modalTitle:String,handleIcon:{type:[String,Boolean],default:void 0},title:String,allowRemove:{type:Boolean,default:!0},onOpen:{type:Function,default:function(){}},onOk:{type:Function,default:function(){}},onCancel:{type:Function,default:function(){}},onLoad:{type:Function,default:function(){}},onBeforeRemove:{type:Function,default:function(){}},onRemove:{type:Function,default:function(){}},onHandle:Function,modal:{type:Object,default:function(){return{}}},srcKey:[String,Number],modelValue:[Array,String,Number,Object],previewMask:void 0,footer:{type:Boolean,default:!0},reload:{type:Boolean,default:!0},closeBtn:{type:Boolean,default:!0},okBtn:{type:Boolean,default:!0},formCreateInject:Object},emits:["update:modelValue","change"],components:{FolderOutlined:g,EyeOutlined:I},data:function(){return{fileList:d(this.modelValue),previewVisible:!1,frameVisible:!1,previewImage:"",bus:new h}},watch:{modelValue:function(e){this.fileList=d(e)}},methods:{close:function(){this.closeModal(!0)},closeModal:function(e){this.bus.$emit(e?"$close":"$ok"),this.reload&&(this.bus.$off("$ok"),this.bus.$off("$close")),this.frameVisible=!1},handleCancel:function(){this.previewVisible=!1},showModal:function(){this.disabled||!1===this.onOpen()||(this.frameVisible=!0)},input:function(){var e=this.fileList,t=1===this.maxLength?e[0]||"":e;this.$emit("update:modelValue",t),this.$emit("change",t)},makeInput:function(){var e=this,t=o(this.icon),n={addonAfter:function(){return r(t,{class:"_fc-frame-icon",onClick:e.showModal},null)}};return this.fileList.length&&(n.suffix=function(){return r(m,{class:"_fc-frame-icon",onClick:function(){e.fileList=[],e.input()}},null)}),r(o("AInput"),{readonly:!0,value:this.fileList.map((function(t){return e.getSrc(t)})).toString(),key:1},n)},makeGroup:function(e){return(!this.maxLength||this.fileList.length<this.maxLength)&&e.push(this.makeBtn()),r("div",{key:2},[e])},makeItem:function(e,t){return r("div",{class:"_fc-files",key:"3"+e},[t])},valid:function(e){var t=this.formCreateInject.field||this.field;if(t&&e!==t)throw new Error("[frame]无效的字段值")},makeIcons:function(e,t){if(!1!==this.handleIcon||!0===this.allowRemove){var n=[];return("file"!==this.type&&!1!==this.handleIcon||"file"===this.type&&this.handleIcon)&&n.push(this.makeHandleIcon(e,t)),this.allowRemove&&n.push(this.makeRemoveIcon(e,t)),r("div",{class:"_fc-upload-cover",key:4},[n])}},makeHandleIcon:function(e,t){var n=this,i=o(!0===this.handleIcon||void 0===this.handleIcon?"EyeOutlined":this.handleIcon);return r(i,{class:"_fc-frame-icon",onClick:function(){return n.handleClick(e)},key:"5"+t},null)},makeRemoveIcon:function(e,t){var n=this;return r(O,{class:"_fc-frame-icon",onClick:function(){return n.handleRemove(e)},key:"6"+t},null)},makeFiles:function(){var e=this;return this.makeGroup(this.fileList.map((function(t,n){return e.makeItem(n,[r(w,{class:"_fc-frame-icon",onClick:function(){return e.handleClick(t)}},null),e.makeIcons(t,n)])})))},makeImages:function(){var e=this;return this.makeGroup(this.fileList.map((function(t,n){return e.makeItem(n,[r("img",{src:e.getSrc(t)},null),e.makeIcons(t,n)])})))},makeBtn:function(){var e=this,t=o(this.icon);return r("div",{class:"_fc-upload-btn",onClick:function(){return e.showModal()},key:7},[r(t,{class:"_fc-frame-icon"},null)])},handleClick:function(e){if(this.onHandle)return this.onHandle(e);this.previewImage=this.getSrc(e),this.previewVisible=!0},handleRemove:function(e){this.disabled||!1!==this.onBeforeRemove(e)&&(this.fileList.splice(this.fileList.indexOf(e),1),this.input(),this.onRemove(e))},getSrc:function(e){return this.srcKey?e[this.srcKey]:e},frameLoad:function(e){var t=this;this.onLoad(e);try{!0===this.helper&&(e.form_create_helper={api:this.formCreateInject.api,close:function(e){t.valid(e),t.closeModal()},set:function(e,n){t.valid(e),t.disabled||t.$emit("update:modelValue",n)},get:function(e){return t.valid(e),t.modelValue},onOk:function(e){return t.bus.$on("$ok",e)},onClose:function(e){return t.bus.$on("$close",e)}})}catch(e){console.error(e)}},makeFooter:function(){var e=this,t=this.$props,n=t.okBtnText,i=t.closeBtnText,l=t.closeBtn,c=t.okBtn,a=[];return t.footer?(l&&a.push(r(o("AButton"),{onClick:function(){return!1!==e.onCancel()&&e.closeModal(!0)}},L(i)?i:{default:function(){return[i]}})),c&&a.push(r(o("AButton"),{type:"primary",onClick:function(){return!1!==e.onOk()&&e.closeModal()}},L(n)?n:{default:function(){return[n]}})),a):a}},render:function(){var e,t=this,n=this.type;e="input"===n?this.makeInput():"image"===n?this.makeImages():this.makeFiles();var i=this.$props,l=i.width,s=void 0===l?"30%":l,u=i.height,d=i.src,h=i.title,m=i.modalTitle;return c((function(){t.$refs.frame&&t.frameLoad(t.$refs.frame.contentWindow||{})})),r("div",{class:"_fc-frame"},[e,r(o("aModal"),{mask:this.previewMask,title:m,visible:this.previewVisible,onCancel:function(){return t.previewVisible=!1},footer:null},{default:function(){return[r("img",{style:"width: 100%",src:t.previewImage},null)]}}),r(o("aModal"),a(f({width:s,title:h},this.modal),{visible:this.frameVisible,onCancel:function(){return t.closeModal(!0)}}),{default:function(){return[t.frameVisible||!t.reload?r("iframe",{ref:"frame",src:d,frameborder:"0",style:{height:u,border:"0 none",width:"100%"}},null):null]},footer:function(){return t.makeFooter()}})])},beforeMount:function(){var e=this.formCreateInject,t=e.name,n=e.field,i=e.api;t&&i.on("fc:closeModal:"+t,this.close),n&&i.on("fc:closeModal:"+n,this.close)},beforeUnmount:function(){var e=this.formCreateInject,t=e.name,n=e.field,i=e.api;t&&i.off("fc:closeModal:"+t,this.close),n&&i.off("fc:closeModal:"+n,this.close)}});export{S as default};
