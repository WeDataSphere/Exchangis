"use strict";(self["webpackChunk_fesjs_template"]=self["webpackChunk_fesjs_template"]||[]).push([[910],{95910:(e,a,t)=>{t.r(a),t.d(a,{default:()=>N});var l=t(1089),o=t(91706),n=t(56485),i={class:"container"};function r(e,a,t,r,s,u){var b=(0,l.up)("a-button"),p=(0,l.up)("a-input"),c=(0,l.up)("a-form-item"),m=(0,l.up)("a-tag"),d=(0,l.up)("plus-outlined"),j=(0,l.up)("a-select-option"),f=(0,l.up)("a-select"),g=(0,l.up)("a-textarea"),y=(0,l.up)("a-form"),w=(0,l.up)("a-modal");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(w,{visible:e.visible,title:e.actionMap[e.mode],onOk:e.handleOk,onCancel:e.handleCancel},{footer:(0,l.w5)((()=>[(0,l.Wm)(b,{key:"back",onClick:e.handleCancel},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("job.action.cancel")),1)])),_:1},8,["onClick"]),(0,l.Wm)(b,{key:"submit",type:"primary",loading:e.loading,onClick:e.handleOk},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("job.action.save")),1)])),_:1},8,["loading","onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"formRef",model:e.formState,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol},{default:(0,l.w5)((()=>["copy"===e.mode?((0,l.wg)(),(0,l.j4)(c,{key:0,ref:"originName",label:e.$t("job.jobDetail.originJob"),name:"originName"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{value:e.formState.originName,"onUpdate:value":a[0]||(a[0]=a=>e.formState.originName=a),disabled:""},null,8,["value"])])),_:1},8,["label"])):(0,l.kq)("",!0),(0,l.Wm)(c,{ref:"jobName",label:e.$t("job.jobDetail.name"),name:"jobName"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{value:e.formState.jobName,"onUpdate:value":a[1]||(a[1]=a=>e.formState.jobName=a),maxLength:100},null,8,["value"])])),_:1},8,["label"]),(0,l.Wm)(c,{label:e.$t("job.jobDetail.label"),name:"jobLabels"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.state.tags,(a=>((0,l.wg)(),(0,l.j4)(m,{key:a,closable:"",onClose:t=>e.handleClose(a)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a),1)])),_:2},1032,["onClose"])))),128)),e.state.inputVisible?((0,l.wg)(),(0,l.j4)(p,{key:0,ref:"inputRef",value:e.state.inputValue,"onUpdate:value":a[2]||(a[2]=a=>e.state.inputValue=a),type:"text",size:"small",style:{width:"100px"},maxLength:20,onBlur:e.handleInputConfirm,onKeyup:(0,n.withKeys)(e.handleInputConfirm,["enter"])},null,8,["value","onBlur","onKeyup"])):((0,l.wg)(),(0,l.j4)(m,{key:1,style:{background:"#fff","border-style":"dashed"},onClick:e.showInput},{default:(0,l.w5)((()=>[(0,l.Wm)(d)])),_:1},8,["onClick"]))])),_:1},8,["label"]),e.formState.originName?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(c,{key:1,label:e.$t("job.jobDetail.type"),name:"jobType"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{value:e.formState.jobType,"onUpdate:value":a[3]||(a[3]=a=>e.formState.jobType=a)},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{value:"OFFLINE"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.$t("job.type.offline")),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["label"])),(0,l.Wm)(c,{label:e.$t("job.jobDetail.engine"),name:"engineType"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{value:e.formState.engineType,"onUpdate:value":a[4]||(a[4]=a=>e.formState.engineType=a),disabled:!!e.formState.originName},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.engines,(e=>((0,l.wg)(),(0,l.j4)(j,{key:e,value:e},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","disabled"])])),_:1},8,["label"]),(0,l.Wm)(c,{label:e.$t("job.jobDetail.description"),name:"jobDesc"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{value:e.formState.jobDesc,"onUpdate:value":a[5]||(a[5]=a=>e.formState.jobDesc=a),maxLength:200},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model","rules","label-col","wrapper-col"])])),_:1},8,["visible","title","onOk","onCancel"])])}t(82526),t(54747),t(49337),t(86778);var s=t(25318),u=t(4942),b=t(44925),p=t(15861),c=t(87757),m=t.n(c),d=(t(74916),t(23123),t(57327),t(41539),t(66992),t(33948),t(26699),t(32023),t(73210),t(74670)),j=t(63467),f=t(36159),g=t(23746),y=["originName"];function w(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);a&&(l=l.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,l)}return t}function v(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?w(Object(t),!0).forEach((function(a){(0,u.Z)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}const k=(0,l.aZ)({components:{PlusOutlined:j.Z},props:{visible:Boolean,editData:Object,projectId:String,mode:String},emits:["handleJobAction"],setup(e,a){var t={create:"创建任务",copy:"复制任务",modify:"编辑任务"},o={create:"创建任务成功",copy:"复制任务成功",modify:"编辑任务成功"},n=(0,f.QT)({useScope:"global"}),i=n.t,r=(0,d.iH)(),u=(0,d.qj)({id:"",originName:"",jobName:"",jobType:"OFFLINE",engineType:"",jobLabels:"",jobDesc:""}),c=(0,d.iH)(),j=(0,d.qj)({tags:[],inputVisible:!1,inputValue:""}),w=e=>{u.jobName=e.jobName||"",u.jobType=e.jobType||"",u.engineType=e.engineType||"",u.jobLabels=e.jobLabels||"",u.jobDesc=e.jobDesc||"",u.id=e.id||""};(0,l.m0)((()=>{var a=e.editData,t=e.mode;w(a),"copy"===t?(u.originName=a.jobName,u.jobName="",j.tags=a.jobLabels?a.jobLabels.split(","):[]):"modify"===t&&(j.tags=a.jobLabels?a.jobLabels.split(","):[])}));var k=(0,d.qj)({engines:[]});(0,l.bv)((0,p.Z)(m().mark((function e(){var a;return m().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,g.Gd)();case 2:a=e.sent,k.engines=a&&a.result||[],console.log(a);case 5:case"end":return e.stop()}}),e)}))));var h={jobName:[{required:!0,message:i("job.jobDetail.jobNameEmpty"),trigger:"blur"}],jobType:[{required:!0,message:i("job.jobDetail.jobTypeEmpty"),trigger:"change"}],engineType:[{required:!0,message:i("job.jobDetail.engineEmpty"),trigger:"change"}]},D=()=>{r.value.validate().then((0,p.Z)(m().mark((function t(){var l,n,i,p,c,f;return m().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(l=(0,d.IU)(u),n=(0,d.IU)(j.tags),l.originName,i=(0,b.Z)(l,y),p=(0,d.IU)(e.editData),"copy"!==e.mode){t.next=11;break}return c={jobName:i.jobName,jobLabels:n.join(","),jobDesc:i.jobDesc},t.next=8,(0,g.Nx)(p.id,c);case 8:f=t.sent,t.next=23;break;case 11:if("create"!==e.mode){t.next=18;break}return c=v(v({},i),{},{projectId:e.projectId,jobLabels:n.join(",")}),t.next=15,(0,g.Cq)(c);case 15:f=t.sent,t.next=23;break;case 18:if("modify"!==e.mode){t.next=23;break}return c=v(v({},i),{},{jobLabels:n.join(",")}),t.next=22,(0,g.Ex)(p.id,c);case 22:f=t.sent;case 23:f&&f.result&&(s.Z.success(o[e.mode]),a.emit("handleJobAction",v(v({},c),p)),r.value.resetFields(),p.jobLabels=f.result.jobLabels?f.result.jobLabels:"",j.tags=[],j.inputVisible=!1,j.inputValue="");case 24:case"end":return t.stop()}}),t)})))).catch((e=>{console.log(e)}))},N=()=>{a.emit("handleJobAction"),r.value.resetFields(),j.tags=[],j.inputVisible=!1,j.inputValue=""},O=e=>{var a=j.tags.filter((a=>a!==e));j.tags=[...a]},C=()=>{j.inputVisible=!0,(0,l.Y3)((()=>{c.value.focus()}))},_=()=>{var e=j.inputValue,a=j.tags;e&&!a.includes(e.trim())&&(a=[...a,e.trim()]),j.tags=a,j.inputVisible=!1,j.inputValue=""};return v(v({formRef:r,loading:!1,labelCol:{span:5},wrapperCol:{span:19},formState:u,rules:h,handleOk:D,handleCancel:N,state:j},(0,d.BK)(k)),{},{handleClose:O,showInput:C,handleInputConfirm:_,inputRef:c,actionMap:t})}});var h=t(53629);const D=(0,h.Z)(k,[["render",r]]),N=D}}]);