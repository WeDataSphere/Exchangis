"use strict";(self["webpackChunk_fesjs_template"]=self["webpackChunk_fesjs_template"]||[]).push([[447],{93447:(e,a,r)=>{r.r(a),r.d(a,{default:()=>U});r(66992),r(33948);var t=r(1089),l=e=>((0,t.dD)("data-v-8bb7a95e"),e=e(),(0,t.Cn)(),e),n=l((()=>(0,t._)("div",{class:"cm-title"},[(0,t._)("span",null,"任务配置")],-1))),s=(0,t.Uk)(" 全量 "),o=(0,t.Uk)(" 增量 "),u=l((()=>(0,t._)("div",{class:"cm-title"},[(0,t._)("span",null,"任务变量")],-1))),i=l((()=>(0,t._)("span",null,"添加变量",-1))),c={style:{"overflow-y":"auto","max-height":"150px"},id:"variable-modification"},d=l((()=>(0,t._)("span",{class:"fl separator"},"=",-1)));function m(e,a,r,l,m,p){var f=(0,t.up)("a-input"),v=(0,t.up)("a-form-item"),b=(0,t.up)("a-radio"),y=(0,t.up)("a-radio-group"),k=(0,t.up)("PlusOutlined"),x=(0,t.up)("DeleteOutlined"),h=(0,t.up)("a-form"),w=(0,t.up)("a-modal");return(0,t.wg)(),(0,t.j4)(w,{title:"设置",visible:r.visible,"confirm-loading":l.confirmLoading,onOk:l.handleOk,onCancel:a[4]||(a[4]=a=>e.$emit("update:visible",!1))},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{ref:"formRef",rules:l.rules,model:l.formState,"label-col":{span:4},class:"config-modal-form"},{default:(0,t.w5)((()=>[n,(0,t.Wm)(v,{label:"执行用户",name:"proxyUser"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{value:l.formState.proxyUser,"onUpdate:value":a[0]||(a[0]=e=>l.formState.proxyUser=e),style:{width:"366px"}},null,8,["value"])])),_:1}),(0,t.Wm)(v,{label:"执行节点",name:"executeNode"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{value:l.formState.executeNode,"onUpdate:value":a[1]||(a[1]=e=>l.formState.executeNode=e),style:{width:"366px"}},null,8,["value"])])),_:1}),(0,t.Wm)(v,{label:"同步方式",name:"syncType"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{value:l.formState.syncType,"onUpdate:value":a[2]||(a[2]=e=>l.formState.syncType=e),name:"syncType"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{value:"FULL"},{default:(0,t.w5)((()=>[s])),_:1}),(0,t.Wm)(b,{value:"INCREMENTAL"},{default:(0,t.w5)((()=>[o])),_:1})])),_:1},8,["value"])])),_:1}),u,(0,t._)("div",{class:"cm-button",onClick:a[3]||(a[3]=function(){return l.createTask&&l.createTask(...arguments)}),style:{cursor:"pointer"}},[(0,t.Wm)(k,{style:{"margin-right":"8px","font-size":"12px"}}),i]),(0,t._)("div",c,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(l.formState.jobParams,((e,a)=>((0,t.wg)(),(0,t.iD)("div",{style:{overflow:"hidden",position:"relative"},key:a},[(0,t.Wm)(v,{class:"w50 fl",label:a+1,name:"jobParamsKey",labelAlign:"left","label-col":{span:3}},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{value:e.key,"onUpdate:value":a=>e.key=a,style:{width:"194px"}},null,8,["value","onUpdate:value"])])),_:2},1032,["label"]),d,(0,t.Wm)(v,{class:"w40 fl",name:"jobParamsValue"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{value:e.value,"onUpdate:value":a=>e.value=a,style:{width:"194px"}},null,8,["value","onUpdate:value"])])),_:2},1024),(0,t.Wm)(x,{class:"delete-icon",onClick:e=>l.deleteTask(a)},null,8,["onClick"])])))),128))])])),_:1},8,["rules","model"])])),_:1},8,["visible","confirm-loading","onOk"])}r(86778);var p=r(25318),f=r(15861),v=r(87757),b=r.n(v),y=(r(41539),r(88674),r(74916),r(40561),r(74670)),k=r(63467),x=r(42255),h=r(68652),w=function(){var e=(0,f.Z)(b().mark((function e(a,r){var t;return b().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,""!=r){e.next=3;break}return e.abrupt("return",Promise.resolve());case 3:if(t.test(r)){e.next=7;break}return e.abrupt("return",Promise.reject("请正确填写执行节点"));case 7:return e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}}),e)})));return function(a,r){return e.apply(this,arguments)}}(),g={proxyUser:[{required:!0,message:"请正确填写执行用户",trigger:"blur"}],syncType:[{required:!0,message:"请正确填写同步方式",trigger:"change"}],executeNode:[{validator:w,trigger:"change"}]};const j={name:"JobManagementConfigModal",components:{PlusOutlined:k.Z,DeleteOutlined:x.Z},props:{visible:{type:Boolean,required:!0},id:{type:String,default:""},formData:{type:Object,default:()=>{}}},emits:["finish","cancel","update:visible"],setup(e,a){var r=(0,y.iH)(!1),l=(0,y.qj)({executeNode:e.formData.executeNode||"",jobParams:e.formData.jobParams||[],proxyUser:e.formData.proxyUser||"",syncType:e.formData.syncType||"FULL"}),n=(0,y.iH)();function s(){return o.apply(this,arguments)}function o(){return o=(0,f.Z)(b().mark((function e(){var a,r;return b().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!l.jobParams.length){e.next=4;break}if(a=l.jobParams[l.jobParams.length-1],a.key&&a.value){e.next=4;break}return e.abrupt("return",p.Z.error("请先填写变量"));case 4:return l.jobParams.push({key:"",value:""}),e.next=7,(0,t.Y3)();case 7:r=document.querySelector("#variable-modification"),r.scrollTop=r.scrollHeight;case 9:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}(0,t.YP)((()=>e.formData),((e,a)=>{var r=e;r.jobParams||(r.jobParams=[]);for(var t=r["jobParams"]?Object.keys(r["jobParams"]):[],n=[],s=0;s<t.length;s++){var o=t[s],u=r["jobParams"][o],i=Object.create(null);i.key=o,i.value=u,n.push(i)}r["jobParams"]=n,l["executeNode"]=r["executeNode"]||"",l["proxyUser"]=r["proxyUser"]||"",l["syncType"]=r["syncType"]||"FULL",l["jobParams"]=r["jobParams"]||""}));var u=e=>{l.jobParams.splice(e,1)},i=function(){var e=(0,f.Z)(b().mark((function e(){var t,s;return b().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.value.validate();case 2:if(t=(0,h.Z)(l),!t.jobParams){e.next=11;break}s=0;case 5:if(!(s<t.jobParams.length)){e.next=11;break}if(t.jobParams[s].key&&t.jobParams[s].value){e.next=8;break}return e.abrupt("return",p.Z.error("任务变量不能为空，请填写或删除"));case 8:s++,e.next=5;break;case 11:r.value=!1,a.emit("update:visible",!1),a.emit("finish",t);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{formRef:n,rules:g,confirmLoading:r,formState:l,createTask:s,handleOk:i,deleteTask:u}}};var P=r(53629);const _=(0,P.Z)(j,[["render",m],["__scopeId","data-v-8bb7a95e"]]),U=_}}]);